<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Reference · JLpeg</title><meta name="title" content="Reference · JLpeg"/><meta property="og:title" content="Reference · JLpeg"/><meta property="twitter:title" content="Reference · JLpeg"/><meta name="description" content="Documentation for JLpeg."/><meta property="og:description" content="Documentation for JLpeg."/><meta property="twitter:description" content="Documentation for JLpeg."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.svg" alt="JLpeg logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">JLpeg</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">JLpeg Guide</a></li><li class="is-active"><a class="tocitem" href>Reference</a><ul class="internal"><li><a class="tocitem" href="#Core-API"><span>Core API</span></a></li><li><a class="tocitem" href="#Pattern-Matching"><span>Pattern Matching</span></a></li><li><a class="tocitem" href="#Constructing-Patterns"><span>Constructing Patterns</span></a></li><li><a class="tocitem" href="#JLpeg.Combinators"><span>JLpeg.Combinators</span></a></li><li><a class="tocitem" href="#Captures-and-Actions"><span>Captures and Actions</span></a></li><li><a class="tocitem" href="#Rules-and-Grammars"><span>Rules and Grammars</span></a></li><li><a class="tocitem" href="#Dialects"><span>Dialects</span></a></li><li><a class="tocitem" href="#Generators"><span>Generators</span></a></li></ul></li><li><a class="tocitem" href="../internals/">Internals</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Reference</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Reference</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/mnemnion/JLpeg.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/mnemnion/JLpeg.jl/blob/trunk/docs/src/reference.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Reference"><a class="docs-heading-anchor" href="#Reference">Reference</a><a id="Reference-1"></a><a class="docs-heading-anchor-permalink" href="#Reference" title="Permalink"></a></h1><ul><li><a href="#Reference">Reference</a></li><li class="no-marker"><ul><li><a href="#Core-API">Core API</a></li><li><a href="#Pattern-Matching">Pattern Matching</a></li><li><a href="#Constructing-Patterns">Constructing Patterns</a></li><li><a href="#JLpeg.Combinators">JLpeg.Combinators</a></li><li><a href="#Captures-and-Actions">Captures and Actions</a></li><li><a href="#Rules-and-Grammars">Rules and Grammars</a></li><li><a href="#Dialects">Dialects</a></li><li><a href="#Generators">Generators</a></li></ul></li></ul><h2 id="Core-API"><a class="docs-heading-anchor" href="#Core-API">Core API</a><a id="Core-API-1"></a><a class="docs-heading-anchor-permalink" href="#Core-API" title="Permalink"></a></h2><p>The basic structure of recognition in JLPeg is a <code>Pattern</code>.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JLpeg.Pattern" href="#JLpeg.Pattern"><code>JLpeg.Pattern</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Container for various patterns and grammars.  Always has <code>val</code>, which may be primitive or a Vector of patterns, and <code>code</code>, a Vector of Instructions. Some patterns have fields unique to that type of pattern.  A pattern which encloses other patterns will have an <code>aux</code> field containing a Dict for metadata.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mnemnion/JLpeg.jl/blob/a1761b99db65214ab4d53e146ff394ef1dc40a29/src/types.jl#L27-L32">source</a></section></article><p>These are created in a wide variety of ways, all based on three functions, <a href="#JLpeg.P"><code>P</code></a>, <a href="#JLpeg.S-Tuple{AbstractString}"><code>S</code></a>, and <a href="#JLpeg.R-Tuple{AbstractString}"><code>R</code></a>, with the rest of the work done with a great quantity of operator overloading.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JLpeg.PegMatch" href="#JLpeg.PegMatch"><code>JLpeg.PegMatch</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">PegMatch &lt;: AbstractMatch</code></pre><p>A type representing a successful match of a <a href="#JLpeg.Pattern"><code>Pattern</code></a> on a string.  Typically returned from the <a href="#Base.match"><code>match</code></a> function.  <a href="#JLpeg.PegFail"><code>PegFail</code></a> is the atypical return value.</p><p>A <code>PegMatch</code> is equal (<code>==</code>) to a <code>Vector</code> if the captures are equal to the <code>Vector</code>.</p><p>For details of how to make use of a <code>PegMatch</code>, see the section &quot;Working With Matched Data&quot; in the documentation.</p><p>Properties:</p><ul><li><code>subject::AbstractString</code>:  Stores the string matched.</li><li><code>full::Bool</code>:  Whether the match is of the entire string.</li><li><code>captures::PegCapture</code>:  Contains any captures from matching <code>patt</code> to <code>subject</code>.   This can in principle contain anything, as captures may call functions, in which   case the return value of that function becomes the capture.  For more   information, consult the <code>JLPeg</code> documentation, and the docstrings for <code>C</code>, <code>Cg</code>,   <code>Cc</code>, and <code>A</code>.</li><li><code>offsets::Vector{Int}</code>:  Provided for compatibility with <code>AbstractMatch</code>.  <code>SubString</code>s contain their own offsets, so this is unnecessary for normal work,  but we generate them when <code>match.offsets</code> is used.  It then consists of the  indices at which the outer layer of captures may be found within the subject.</li><li><code>patt::Pattern</code>: The pattern matched against the subject.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mnemnion/JLpeg.jl/blob/a1761b99db65214ab4d53e146ff394ef1dc40a29/src/pegmatch.jl#L39-L65">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JLpeg.PegCapture" href="#JLpeg.PegCapture"><code>JLpeg.PegCapture</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">PegCapture &lt;: AbstractVector</code></pre><p>The captures (including group captures) of a <a href="#JLpeg.PegMatch"><code>PegMatch</code></a>. Indexes and iterates in the same fashion.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mnemnion/JLpeg.jl/blob/a1761b99db65214ab4d53e146ff394ef1dc40a29/src/pegmatch.jl#L5-L10">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JLpeg.PegFail" href="#JLpeg.PegFail"><code>JLpeg.PegFail</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">PegFail</code></pre><p>Returned on a failure to <code>match(patt:Pattern, subject::AbstractString)</code>.</p><p><strong>Properties</strong></p><ul><li><code>subject::AbstractString</code>:  The string that we failed to match on.</li><li><code>errpos</code>: The position at which the pattern ultimately failed to match.</li><li><code>label::Symbol</code>: Info about the failure provided by <code>T(::symbol)</code>, defaulting to       <code>:default</code> if the pattern fails but not at a throw point, or if no throws are       provided.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mnemnion/JLpeg.jl/blob/a1761b99db65214ab4d53e146ff394ef1dc40a29/src/pegmatch.jl#L313-L326">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JLpeg.PegError" href="#JLpeg.PegError"><code>JLpeg.PegError</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">PegError(msg) &lt;: Exception</code></pre><p>An error while constructing a <a href="#JLpeg.Pattern"><code>Pattern</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mnemnion/JLpeg.jl/blob/a1761b99db65214ab4d53e146ff394ef1dc40a29/src/types.jl#L35-L39">source</a></section></article><h2 id="Pattern-Matching"><a class="docs-heading-anchor" href="#Pattern-Matching">Pattern Matching</a><a id="Pattern-Matching-1"></a><a class="docs-heading-anchor-permalink" href="#Pattern-Matching" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.match" href="#Base.match"><code>Base.match</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">match(patt::Pattern, subject::AbstractString)::Union{PegMatch, PegFail}</code></pre><p>Match <code>patt</code> to <code>subject</code>, returning a <code>PegMatch</code> implementing the expected interface for its supertype <code>AbstractMatch</code>, or a <code>PegFail</code> with useful information about the failure.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mnemnion/JLpeg.jl/blob/a1761b99db65214ab4d53e146ff394ef1dc40a29/src/vm.jl#L906-L912">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JLpeg.compile!" href="#JLpeg.compile!"><code>JLpeg.compile!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">compile!(patt::Pattern)::Pattern</code></pre><p>Compile a <a href="#JLpeg.Pattern"><code>Pattern</code></a>.  It isn&#39;t necessary to call this, <code>match</code> will compile a <code>Pattern</code> if necessary, but this is a useful thing to do during precompilation.</p><p>This translates the Pattern to Instruction codes, appending them to the <code>code</code> field and returning same.  Performs various optimizations in the process.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mnemnion/JLpeg.jl/blob/a1761b99db65214ab4d53e146ff394ef1dc40a29/src/compile.jl#L404-L415">source</a></section></article><h2 id="Constructing-Patterns"><a class="docs-heading-anchor" href="#Constructing-Patterns">Constructing Patterns</a><a id="Constructing-Patterns-1"></a><a class="docs-heading-anchor-permalink" href="#Constructing-Patterns" title="Permalink"></a></h2><p>Patterns are built by <a href="../#Combination">combining</a> the products of these constructors into more complex Patterns.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JLpeg.P" href="#JLpeg.P"><code>JLpeg.P</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">P(p::Union{AbstractString,AbstractChar,Integer,Bool,Symbol})::Pattern</code></pre><p>Create a <a href="#JLpeg.Pattern"><code>Pattern</code></a>.</p><ul><li>If <code>p</code> is a <code>String</code> or <code>Char</code>, this matches that string or character.</li><li>If <code>p</code> is a positive <code>Integer</code>, it matches that many characters.</li><li>If <code>p</code> is <code>true</code>, the rules succeeds, if <code>false</code>, the rule fails.</li><li>If <code>p</code> is a <code>Symbol</code>, this represents a call to the rule with that name.</li><li>If <code>p</code> is a negative <code>Integer</code>, matches if that many characters remain, consumes no input.</li><li>If <code>p</code> is already a <code>Pattern</code>, it is simply returned.</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; match(P(&quot;func&quot;), &quot;funci&quot;)
PegMatch([&quot;func&quot;])

julia&gt; match(P(3), &quot;three&quot;)
PegMatch([&quot;thr&quot;])

julia&gt; match(P(true), &quot;pass&quot;)
PegMatch([&quot;&quot;])

julia&gt; match(P(false), &quot;fail&quot;)
PegFail(&quot;fail&quot;, 1)

julia&gt; match(P(&#39;👍&#39;), &quot;👍&quot;)
PegMatch([&quot;👍&quot;])</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mnemnion/JLpeg.jl/blob/a1761b99db65214ab4d53e146ff394ef1dc40a29/src/interface.jl#L4-L34">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JLpeg.@P_str" href="#JLpeg.@P_str"><code>JLpeg.@P_str</code></a> — <span class="docstring-category">Macro</span></header><section><div><pre><code class="language-julia hljs">P&quot;str&quot;</code></pre><p>Call P(str) on the String, in close imitation of Lua&#39;s calling convention.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mnemnion/JLpeg.jl/blob/a1761b99db65214ab4d53e146ff394ef1dc40a29/src/interface.jl#L293-L297">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JLpeg.S-Tuple{AbstractString}" href="#JLpeg.S-Tuple{AbstractString}"><code>JLpeg.S</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">S(s::AbstractString)</code></pre><p>Create a Pattern matching any character in the string.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mnemnion/JLpeg.jl/blob/a1761b99db65214ab4d53e146ff394ef1dc40a29/src/interface.jl#L57-L61">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JLpeg.@S_str" href="#JLpeg.@S_str"><code>JLpeg.@S_str</code></a> — <span class="docstring-category">Macro</span></header><section><div><pre><code class="language-julia hljs">S&quot;str&quot;</code></pre><p>Create a Set pattern of the characters in &quot;str&quot;.  See <a href="#JLpeg.S-Tuple{AbstractString}"><code>S</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mnemnion/JLpeg.jl/blob/a1761b99db65214ab4d53e146ff394ef1dc40a29/src/interface.jl#L311-L315">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JLpeg.R-Tuple{AbstractString}" href="#JLpeg.R-Tuple{AbstractString}"><code>JLpeg.R</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">R(s::AbstractString)</code></pre><p>Create a Pattern matching every character in the range from the first to the second character.  <code>s</code> must be two codepoints long, and the first must be lower-valued than the second.  Both must be valid UTF-8.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mnemnion/JLpeg.jl/blob/a1761b99db65214ab4d53e146ff394ef1dc40a29/src/interface.jl#L65-L71">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JLpeg.R-Tuple{AbstractChar, AbstractChar}" href="#JLpeg.R-Tuple{AbstractChar, AbstractChar}"><code>JLpeg.R</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">R(a::AbstractChar, b::AbstractChar)</code></pre><p>Match any character in the range <code>a</code> to <code>b</code>, inclusive.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mnemnion/JLpeg.jl/blob/a1761b99db65214ab4d53e146ff394ef1dc40a29/src/interface.jl#L85-L89">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JLpeg.@R_str" href="#JLpeg.@R_str"><code>JLpeg.@R_str</code></a> — <span class="docstring-category">Macro</span></header><section><div><pre><code class="language-julia hljs">R&quot;str&quot;</code></pre><p>Create a range pattern from &quot;str&quot;.  See <a href="#JLpeg.R-Tuple{AbstractString}"><code>R</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mnemnion/JLpeg.jl/blob/a1761b99db65214ab4d53e146ff394ef1dc40a29/src/interface.jl#L302-L306">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JLpeg.B" href="#JLpeg.B"><code>JLpeg.B</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">B(p::Union{Pattern,AbstractString,AbstractChar,Integer})</code></pre><p>Match <code>patt</code> behind the current subject index. <code>patt</code> must be of fixed length.  The most useful <code>B</code> patterns are <code>!B(1)</code>, which succeeds at the beginning of the string, and <code>B(&#39;\n&#39;)|!B(1)</code> to match the start of a line.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mnemnion/JLpeg.jl/blob/a1761b99db65214ab4d53e146ff394ef1dc40a29/src/interface.jl#L92-L98">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JLpeg.U8" href="#JLpeg.U8"><code>JLpeg.U8</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">U8(val::Integer)</code></pre><p>Matches a single byte, whether or not that byte is a valid part of a UTF-8 string.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mnemnion/JLpeg.jl/blob/a1761b99db65214ab4d53e146ff394ef1dc40a29/src/interface.jl#L102-L106">source</a></section></article><h2 id="JLpeg.Combinators"><a class="docs-heading-anchor" href="#JLpeg.Combinators">JLpeg.Combinators</a><a id="JLpeg.Combinators-1"></a><a class="docs-heading-anchor-permalink" href="#JLpeg.Combinators" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JLpeg.Combinators" href="#JLpeg.Combinators"><code>JLpeg.Combinators</code></a> — <span class="docstring-category">Module</span></header><section><div><pre><code class="language-julia hljs">JLpeg.Combinators</code></pre><p>Contains all the combinator operators which shadow definitions in Base.  The module redefines these symbols, providing a fallback to the Base, and are designed not to break existing code.  The Julia compiler handles this kind of redirection well during inference, this technique is used by several packages which specialize operators for numerically-demanding tasks, without issue; we even transfer the Base docstrings.</p><p>Whether or not these overloads rise to the level of piracy is debatable.  That said, we&#39;ve walled them off, so that debate is not necessary.</p><p><strong>Use</strong></p><p>The <a href="#JLpeg.GrammarMacros.@grammar"><code>@grammar</code></a> and <a href="#JLpeg.GrammarMacros.@rule"><code>@rule</code></a> macros are able to use these operators, so you may not need them.  To import them, add this to your module:</p><pre><code class="language-julia hljs">import JLpeg.Combinators: *, -, %, |, ^, ~, !, &gt;&gt;, inv</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mnemnion/JLpeg.jl/blob/a1761b99db65214ab4d53e146ff394ef1dc40a29/src/interface.jl#L363-L383">source</a></section></article><h2 id="Captures-and-Actions"><a class="docs-heading-anchor" href="#Captures-and-Actions">Captures and Actions</a><a id="Captures-and-Actions-1"></a><a class="docs-heading-anchor-permalink" href="#Captures-and-Actions" title="Permalink"></a></h2><p>PEG patterns are recognizers, matching the longest prefix of the string which they&#39;re able.  <a href="../#Captures">Captures</a> allow for substrings to be captured within the match, <a href="../#Actions">Actions</a> perform actions at the index of the match, or on a capture.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JLpeg.C" href="#JLpeg.C"><code>JLpeg.C</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">C(patt::Pattern)</code></pre><p>Create a capture. Matching <code>patt</code> will return the matched substring.  The sugared form is <code>(patt,)</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mnemnion/JLpeg.jl/blob/a1761b99db65214ab4d53e146ff394ef1dc40a29/src/interface.jl#L111-L116">source</a></section><section><div><pre><code class="language-julia hljs">C(patt::Pattern, sym::Union{Symbol,AbstractString})</code></pre><p>Create a named capture with key :sym or &quot;sym&quot;.  Sugared form <code>(patt, :sym)</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mnemnion/JLpeg.jl/blob/a1761b99db65214ab4d53e146ff394ef1dc40a29/src/interface.jl#L120-L124">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JLpeg.Cg" href="#JLpeg.Cg"><code>JLpeg.Cg</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">Cg(patt::Pattern [, sym::Union{Symbol,AbstractString}])</code></pre><p>Create a group capture, which groups all captures from P into a vector inside the <code>PegMatch</code> object.  If <code>sym</code> is provided, the group will be found at that key.  Sugared as <code>[patt]</code> or <code>[patt, :sym]</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mnemnion/JLpeg.jl/blob/a1761b99db65214ab4d53e146ff394ef1dc40a29/src/interface.jl#L132-L138">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JLpeg.Cr" href="#JLpeg.Cr"><code>JLpeg.Cr</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">Cr(patt::Pattern, sym::Union{CapSym, Nothing})</code></pre><p>Captures a <code>UnitRange</code> of matches in <code>patt</code>, optionally keyed by <code>sym</code>. Convenient for substitutions and annotations.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mnemnion/JLpeg.jl/blob/a1761b99db65214ab4d53e146ff394ef1dc40a29/src/interface.jl#L175-L180">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JLpeg.Cc" href="#JLpeg.Cc"><code>JLpeg.Cc</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">Cc(args...)</code></pre><p>Constant capture. Matches the empty string and puts the values of <code>args</code> as a tuple in that place within the <code>PegMatch</code> captures.  If <code>args</code> is a <code>Pair{Symbol,Any}</code>, that symbol will appear as a key in the match.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mnemnion/JLpeg.jl/blob/a1761b99db65214ab4d53e146ff394ef1dc40a29/src/interface.jl#L164-L170">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JLpeg.Cp" href="#JLpeg.Cp"><code>JLpeg.Cp</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">Cp()</code></pre><p>Captures the empty string in <code>.captures</code>, consuming no input.  Useful for the side effect, of storing the corresponding offset.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mnemnion/JLpeg.jl/blob/a1761b99db65214ab4d53e146ff394ef1dc40a29/src/interface.jl#L154-L159">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JLpeg.M" href="#JLpeg.M"><code>JLpeg.M</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">M(patt::Pattern, sym::Symbol)</code></pre><p><code>M</code>ark the match of a pattern for later examination with <a href="#JLpeg.K"><code>K</code></a>.</p><p>See also <a href="#JLpeg.CM"><code>CM</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mnemnion/JLpeg.jl/blob/a1761b99db65214ab4d53e146ff394ef1dc40a29/src/interface.jl#L244-L250">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JLpeg.CM" href="#JLpeg.CM"><code>JLpeg.CM</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">CM(patt::Pattern, sym::Symbol)</code></pre><p>Mark the match of <code>patt</code> with <code>sym</code>, while also capturing it with <code>sym</code>.</p><p>See <a href="#JLpeg.M"><code>M</code></a> and <a href="#JLpeg.C"><code>C</code></a> for details.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mnemnion/JLpeg.jl/blob/a1761b99db65214ab4d53e146ff394ef1dc40a29/src/interface.jl#L253-L259">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JLpeg.K" href="#JLpeg.K"><code>JLpeg.K</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">K(patt::Pattern, sym::Symbol, [check::Union{Function,Symbol}])</code></pre><p>Chec<code>K</code> the pattern against the previous <a href="#JLpeg.M"><code>Mark</code></a> with the same tag. If <code>check</code> is not provided, it will return <code>true</code> if the SubStrings of the mark and check are identical, otherwise it must be either a symbol representing one of the builtins or a function with the signature <code>(marked::SubString, checked::SubString)::Bool</code>.  The success or failure of the check is the success or failure of the pattern.  If <code>patt</code> doesn&#39;t match, the check will not be performed. The check will always fail if the corresponding mark is not present, except for the builtin <code>:always</code>, which always succeeds if <code>patt</code> succeeds.</p><p><code>K</code> may also be written in <a href="https://docs.julialang.org/en/v1/manual/functions/#Do-Block-Syntax-for-Function-Arguments">do syntax</a>, <code>K(patt, :tag) do s1, s2; ... end</code>.</p><p>See also <a href="#JLpeg.CK"><code>CK</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mnemnion/JLpeg.jl/blob/a1761b99db65214ab4d53e146ff394ef1dc40a29/src/interface.jl#L262-L278">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JLpeg.CK" href="#JLpeg.CK"><code>JLpeg.CK</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">CK(patt::Pattern, sym::Symbol, check::Union{Function,Symbol})</code></pre><p>Chec<code>K</code> the pattern against the prior [<code>Mark</code>], capturing if the check suceeds. See <a href="#JLpeg.K"><code>K</code></a> and <a href="#JLpeg.C"><code>C</code></a> for details.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mnemnion/JLpeg.jl/blob/a1761b99db65214ab4d53e146ff394ef1dc40a29/src/interface.jl#L283-L288">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JLpeg.A" href="#JLpeg.A"><code>JLpeg.A</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">A(patt::Pattern, λ::Function)</code></pre><p>Acts as a grouping capture for <code>patt</code>, applying <code>λ</code> to a successful match with the captures as arguments (not as a single Vector). If <code>patt</code> contains no captures, the capture is the SubString.  The return value of <code>λ</code> becomes the capture; if <code>nothing</code> is returned, the capture (and its offset) are deleted. May be invoked as <code>patt &lt;| λ</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mnemnion/JLpeg.jl/blob/a1761b99db65214ab4d53e146ff394ef1dc40a29/src/interface.jl#L188-L196">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JLpeg.Q" href="#JLpeg.Q"><code>JLpeg.Q</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">Q(patt::Pattern, λ::Function)</code></pre><p>A <code>Q</code>uery action. <code>λ</code> will receive the <code>SubString</code> matched by <code>patt</code>, and is expected to return a <code>Bool</code> representing the success or failure of the pattern.  This happens during the parse, and may be used, for an example, to maintain a typedef symbol table when parsing C, with appropriate closed-over state variables.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mnemnion/JLpeg.jl/blob/a1761b99db65214ab4d53e146ff394ef1dc40a29/src/interface.jl#L203-L210">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JLpeg.Avm!" href="#JLpeg.Avm!"><code>JLpeg.Avm!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">Avm!(patt::Pattern, λ::Function)</code></pre><p>A vm Action. If <code>patt</code> succeeds, <code>λ</code> will be called on the entire <code>VMState</code>, and is expected to return <code>true</code> or <code>false</code> to describe the success or failure of the entire pattern.  This is an ultimate escape hatch, intended for purposes such as debugging, or imposing user limits on stack depth. The most obvious use is early parse termination, by setting <code>vm.running</code> to <code>false</code>.</p><p>While it may be abused to do all sorts of surprising hacks, if you think you need it in order to parse something, you&#39;re probably wrong about that.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mnemnion/JLpeg.jl/blob/a1761b99db65214ab4d53e146ff394ef1dc40a29/src/interface.jl#L215-L226">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JLpeg.T" href="#JLpeg.T"><code>JLpeg.T</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">T(label::Symbol)</code></pre><p>Throw a failure labeled with <code>:label</code>.  If a rule <code>:label</code> exists, this will be called to attempt recovery, the success or failure of the recovery rule is then used.  Otherwise, <code>:label</code> and the position of <code>T(:label)</code> will be attached to <code>PegFail</code> in the event that the whole match fails at that point in the string.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mnemnion/JLpeg.jl/blob/a1761b99db65214ab4d53e146ff394ef1dc40a29/src/interface.jl#L231-L239">source</a></section></article><h2 id="Rules-and-Grammars"><a class="docs-heading-anchor" href="#Rules-and-Grammars">Rules and Grammars</a><a id="Rules-and-Grammars-1"></a><a class="docs-heading-anchor-permalink" href="#Rules-and-Grammars" title="Permalink"></a></h2><p>The great advantage (other than composability) PEGs have over regular expressions is the ability to match recursive patterns.  These are constructed out of Rules and Grammars.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JLpeg.Grammar" href="#JLpeg.Grammar"><code>JLpeg.Grammar</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">Grammar(rule...)</code></pre><p>Create a grammar from the provided <a href="#JLpeg.Rule"><code>Rules</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mnemnion/JLpeg.jl/blob/a1761b99db65214ab4d53e146ff394ef1dc40a29/src/interface.jl#L39-L43">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JLpeg.Rule" href="#JLpeg.Rule"><code>JLpeg.Rule</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">Rule(name::Symbol, patt::Pattern)</code></pre><p>Sugar-free form of <a href="#JLpeg.GrammarMacros.@rule"><code>@rule</code></a>, creates a rule from <code>patt</code>, assigning it the name <code>name</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mnemnion/JLpeg.jl/blob/a1761b99db65214ab4d53e146ff394ef1dc40a29/src/pattern.jl#L168-L173">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JLpeg.GrammarMacros.@rule" href="#JLpeg.GrammarMacros.@rule"><code>JLpeg.GrammarMacros.@rule</code></a> — <span class="docstring-category">Macro</span></header><section><div><pre><code class="language-julia hljs">@rule :name ← pattern...</code></pre><p>Sugared form for rule definition. Assigns the rule in-scope with the given <code>name</code>:</p><pre><code class="language-julia hljs"># Wrong
name = @rule :name  ←  &quot;foo&quot; | &quot;bar&quot;
# Right
@rule :name ← &quot;foo&quot; | &quot;bar&quot;</code></pre><p>In terms of scope and variable escaping, <code>@rule</code> functions identically to <code>@grammar</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mnemnion/JLpeg.jl/blob/a1761b99db65214ab4d53e146ff394ef1dc40a29/src/grammar.jl#L127-L140">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JLpeg.GrammarMacros.@grammar" href="#JLpeg.GrammarMacros.@grammar"><code>JLpeg.GrammarMacros.@grammar</code></a> — <span class="docstring-category">Macro</span></header><section><div><pre><code class="language-julia hljs">@grammar(name, rules)</code></pre><p>Syntax sugar for defining a set of rules as a single grammar. Expects a block <code>rules</code>, each of which is a rule-pair as can be created with <code>←</code>, or <code>&lt;--</code>. <code>&quot;string&quot;</code> will be interpolated as <code>P(&quot;string&quot;)</code>, <code>:symbol</code> as <code>P(:symbol)</code>, and an integer <code>n</code> as <code>P(n)</code>.</p><p>Any variable name exported by JLpeg will refer to the same value as the export, while any other variable is escaped, and will have the meaning it has in the scope where <code>@grammar</code> is called.</p><p><strong>Example use</strong></p><p>This simple grammar captures the first string of numbers it finds:</p><pre><code class="language-julia-repl hljs">julia&gt; @grammar capnums begin
            :nums  ←  (:num,) | 1 * :nums
            :num   ←  R&quot;09&quot;^1
        end;

julia&gt; match(capnums, &quot;abc123abc123&quot;)
PegMatch([&quot;123&quot;])</code></pre><p>This one also captures the lowercase letters, converting them to uppercase.</p><pre><code class="language-julia-repl hljs">julia&gt; upper = uppercase;  # A thoroughly unhygienic macro

julia&gt; @grammar uppernums begin
           :nums  ←  (:num,) | :abc * :nums
           :num   ←  R&quot;09&quot;^1
           :abc   ←  R&quot;az&quot;^1 &lt;| upper
       end;

julia&gt; match(uppernums, &quot;abc123abc123&quot;)
PegMatch([&quot;ABC&quot;, &quot;123&quot;])</code></pre><p>More extensive examples may be found in the documentation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mnemnion/JLpeg.jl/blob/a1761b99db65214ab4d53e146ff394ef1dc40a29/src/grammar.jl#L76-L118">source</a></section></article><h2 id="Dialects"><a class="docs-heading-anchor" href="#Dialects">Dialects</a><a id="Dialects-1"></a><a class="docs-heading-anchor-permalink" href="#Dialects" title="Permalink"></a></h2><p>A work in progress.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JLpeg.re" href="#JLpeg.re"><code>JLpeg.re</code></a> — <span class="docstring-category">Constant</span></header><section><div><pre><code class="language-julia hljs">re : An Interpretation of LPeg&#39;s `re` module</code></pre><p>The first dialect, intended, among other things, as a useful bootstrap of other dialects.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mnemnion/JLpeg.jl/blob/a1761b99db65214ab4d53e146ff394ef1dc40a29/src/dialects.jl#L3-L8">source</a></section></article><h2 id="Generators"><a class="docs-heading-anchor" href="#Generators">Generators</a><a id="Generators-1"></a><a class="docs-heading-anchor-permalink" href="#Generators" title="Permalink"></a></h2><p>A PEG is a specification of a class of algorithms which are valid on a universe of strings.  While the common thing to do is use this specification to construct a recognizer for such strings, it may also be used to create generators for valid strings in that universe.</p><p>JLpeg aspires to provide a complete set of generators for our patterns. So far, we have:</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JLpeg.generate" href="#JLpeg.generate"><code>JLpeg.generate</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">generate(set::PSet)::String</code></pre><p>Generate a <code>String</code> of all characters matched by a Set.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mnemnion/JLpeg.jl/blob/a1761b99db65214ab4d53e146ff394ef1dc40a29/src/generator.jl#L21-L25">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« JLpeg Guide</a><a class="docs-footer-nextpage" href="../internals/">Internals »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="auto">Automatic (OS)</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.2.1 on <span class="colophon-date" title="Tuesday 6 February 2024 00:28">Tuesday 6 February 2024</span>. Using Julia version 1.9.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
